<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>HTML Fetch Tool</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: system-ui, sans-serif;
  background: linear-gradient(135deg, #667eea, #764ba2);
  padding: 30px;
  color: #333;
}

.container {
  max-width: 900px;
  margin: auto;
  background: #fff;
  padding: 25px;
  border-radius: 12px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.15);
}

h2 {
  margin-bottom: 15px;
}

input {
  width: 100%;
  padding: 12px;
  border-radius: 6px;
  border: 1px solid #ccc;
  font-size: 15px;
}

.selector-row {
  display: flex;
  gap: 10px;
  margin-top: 10px;
}

.selector-row input {
  flex: 1;
}

.add-btn {
  padding: 12px 16px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
  background: #667eea;
  color: #fff;
  font-size: 18px;
}

.fetch-btn {
  margin-top: 15px;
  padding: 14px;
  width: 100%;
  background: #764ba2;
  color: #fff;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
}

.results {
  margin-top: 30px;
}

.result-block {
  background: #f8f9fc;
  border-radius: 10px;
  padding: 15px;
  margin-bottom: 20px;
  position: relative;
}

.result-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.result-header span {
  font-weight: bold;
  color: #667eea;
}

.copy-btn {
  background: #667eea;
  color: #fff;
  border: none;
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 13px;
}

.copy-btn.copied {
  background: #28a745;
}

pre {
  background: #fff;
  padding: 12px;
  border-radius: 6px;
  overflow-x: auto;
  font-size: 13px;
}
</style>
</head>

<body>

<div class="container">
  <h2>Fetch HTML by Class or ID</h2>

  <input id="url" placeholder="Enter page URL (https://example.com)">

  <div id="selectors">
    <div class="selector-row">
      <input placeholder=".class or #id">
      <button class="add-btn" onclick="addSelector()">+</button>
    </div>
  </div>

  <button class="fetch-btn" onclick="fetchContent()">Fetch Content</button>

  <div class="results" id="results"></div>
</div>

<script>
function addSelector() {
  const row = document.createElement('div');
  row.className = 'selector-row';
  row.innerHTML = `
    <input placeholder=".class or #id">
    <button class="add-btn" onclick="this.parentElement.remove()">âˆ’</button>
  `;
  document.getElementById('selectors').appendChild(row);
}

async function fetchContent() {
  const url = document.getElementById('url').value.trim();
  const selectors = [...document.querySelectorAll('#selectors input')]
    .map(i => i.value.trim())
    .filter(Boolean);

  if (!url || selectors.length === 0) {
    alert('Enter URL and at least one selector');
    return;
  }

  const res = await fetch('/api/fetch', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ url, selectors })
  });

  const data = await res.json();
  renderResults(data);
}

function renderResults(data) {
  const results = document.getElementById('results');
  results.innerHTML = '';

  data.forEach(item => {
    const block = document.createElement('div');
    block.className = 'result-block';

    block.innerHTML = `
      <div class="result-header">
        <span>${item.selector}</span>
        <button class="copy-btn" onclick="copyHTML(this)">Copy</button>
      </div>
      <pre>${item.content || 'Not Found'}</pre>
    `;

    results.appendChild(block);
  });
}

function copyHTML(btn) {
  const text = btn.closest('.result-block').querySelector('pre').innerText;
  navigator.clipboard.writeText(text);

  btn.textContent = 'Copied';
  btn.classList.add('copied');

  setTimeout(() => {
    btn.textContent = 'Copy';
    btn.classList.remove('copied');
  }, 1500);
}
</script>

</body>
</html>
